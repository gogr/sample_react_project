(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(t,e,a){t.exports=a(25)},16:function(t,e,a){},17:function(t,e,a){},25:function(t,e,a){"use strict";a.r(e);var s=a(0),n=a.n(s),i=a(9),r=a.n(i),o=(a(16),a(1)),c=a(2),l=a(4),u=a(3),h=a(5),m=(a(17),a(10)),p=a.n(m),d=function(t){return n.a.createElement("svg",Object.assign({width:"500px",height:"500px",viewBox:"0 0 500 500",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",role:"presentation"},t),n.a.createElement("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},n.a.createElement("path",{d:"M426,52 L404,52 L404,8 L360,8 L360,52 L140,52 L140,8 L96,8 L96,52 L74,52 C49.8,52 30,71.8 30,96 L30,448 C30,472.2 49.8,492 74,492 L426,492 C450.2,492 470,472.2 470,448 L470,96 C470,71.8 450.2,52 426,52 Z M426,448 L74,448 L74,162 L426,162 L426,448 Z",fill:"currentColor","fill-rule":"nonzero"})))},f=function(t){return n.a.createElement("svg",Object.assign({width:"174",height:"174",viewBox:"0 0 174 174",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",role:"presentation"},t),n.a.createElement("path",{d:"M79.866 26.627l-17.27-6.399L10 62.557v66.589l52 22.669V85.226l51-41.795 51 41.795v66.589l-52-22.669V95","stroke-width":"20",stroke:"#FFF",fill:"none","fill-rule":"evenodd"}))},g=function(t){function e(){var t,a;Object(o.a)(this,e);for(var s=arguments.length,n=new Array(s),i=0;i<s;i++)n[i]=arguments[i];return(a=Object(l.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(n)))).state={animIn:!1,showingBack:!1},a.toggleBackside=function(t){a.setState({showingBack:!a.state.showingBack})},a.showBackside=function(t){a.setState({showingBack:!0})},a.hideBackside=function(t){a.setState({showingBack:!1})},a.timeStampToMS=function(t){return 1e3*t},a.getClassName=function(){var t=["chat-post"];return a.state.animIn&&t.push("anim-in"),"client"===a.props.userData.id&&t.push("chat-post-fromClient"),t.join(" ")},a}return Object(h.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){this.timeoutId=setTimeout(function(){this.setState({animIn:!0}),this.props.scrollToBottom()}.bind(this),200)}},{key:"componentWillUnmount",value:function(){this.timeoutId&&clearTimeout(this.timeoutId)}},{key:"render",value:function(){return n.a.createElement("li",{className:this.getClassName(),tabIndex:"0",key:this.props.id},n.a.createElement("div",{className:"chat-post-profileImg"},n.a.createElement("span",{className:"chat-post-profileImg-media"},"client"!==this.props.userData.id?n.a.createElement("img",{src:this.props.userData.profileImgSrc,alt:this.props.userData.profileImgAlt}):n.a.createElement(f,null))),n.a.createElement("div",{className:"chat-post-body"},n.a.createElement("div",{className:"chat-post-meta ui_flexwrap-edges ui_text-small"},"client"!==this.props.userData.id?n.a.createElement("div",{className:"chat-meta-user"},this.props.userData.real_name," - @",this.props.userData.username):n.a.createElement("span",{className:"ui_inclusively-hidden"},"you "),n.a.createElement("div",{className:"chat-meta-timeAgo"},n.a.createElement("span",{className:"ui_inclusively-hidden"},"posted "),n.a.createElement(p.a,{datetime:this.timeStampToMS(this.props.postData.ts)}))),n.a.createElement("div",{className:"chat-post-content","data-state-backside":this.state.showingBack?"show":"hide",onTouchStart:this.showBackside,onTouchEnd:this.hideBackside},n.a.createElement("div",{className:"chat-post-message"},this.props.postData.message),n.a.createElement("div",{className:"chat-post-backside"},n.a.createElement("p",null,n.a.createElement("span",{className:"chat-icon-calendar"},n.a.createElement(d,null))," active since July 13, 2017")))))}}]),e}(n.a.Component),v=function(t){return n.a.createElement("svg",Object.assign({width:"24",height:"24",focusable:"false",viewBox:"0 0 24 24","aria-hidden":"true",role:"presentation"},t),n.a.createElement("path",{d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z",fill:"currentColor"}),n.a.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}))},b=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(l.a)(this,Object(u.a)(e).call(this,t))).remainingChars=function(t){var e=a.state.maxPostChars-t.target.value.length;a.setState({remainingPostChars:e})},a.scrollToBottom=function(){a.refs.chatList.scrollTop=a.refs.chatList.scrollHeight},a.handleSubmit=function(t){t.preventDefault(),a.setState({formBusy:!0});var e=Date.now()/1e3,s={id:e,user:"client",message:a.refs.chatInput.value,ts:e};return fetch("/api/posts",{method:"post",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}}).then(function(t){return t.json()}).then(function(t){console.log("res",t);var e=a.state.posts;e.push(s),a.setState({posts:e,formBusy:!1}),a.refs.chatInput.value="",a.refs.chatInput.focus()}),!1},a.state={users:{client:{id:"client",username:"client",real_name:"",verified:!1}},posts:[],status:"Loading Chat ...",postsBusy:!0,formBusy:!1,maxPostChars:140,remainingPostChars:140},a}return Object(h.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){var t=this;fetch("/api/users").then(function(t){return t.json()}).then(function(e){var a=t.state.users;e.map(function(t){return a[t.id]=t,!0}),t.setState({users:a})}),fetch("/api/posts").then(function(t){return t.json()}).then(function(e){return t.setState({posts:e,status:"READY!",postsBusy:!1})})}},{key:"getUserDataByID",value:function(t){if(!this.state.users[t])return null;var e=this.state.users[t];return e.profileImgSrc="/media/users/"+e.username+".jpg",e.profileImgAlt="",e}},{key:"render",value:function(){var t=this;return n.a.createElement("form",{className:"chat","aria-label":"Web Chat","aria-busy":this.state.formBusy,onSubmit:this.handleSubmit},n.a.createElement("a",{href:"#chatInput",className:"ui_showto-focus",role:"button"},"skip to chat input"),this.state.postsBusy?n.a.createElement("div",{className:"chat-status",role:"status","aria-live":"polite"},this.state.status):null,n.a.createElement("ul",{className:"chat-list","aria-label":"Chat Log","aria-busy":this.state.postsBusy?"true":"false","aria-hidden":this.state.postsBusy?"true":"false",tabIndex:"0",ref:"chatList"},this.state.posts.map(function(e){return n.a.createElement(g,{key:e.id,postData:e,userData:t.getUserDataByID(e.user),scrollToBottom:t.scrollToBottom})})),n.a.createElement("div",{className:"chat-input-wrap"},n.a.createElement("label",{htmlFor:"chatInput"},n.a.createElement("span",{className:"ui_inclusively-hidden"},"Chat Input : "),n.a.createElement("span",{className:"chat-input-charCount-wrap","aria-live":"polite"},n.a.createElement("span",{className:"chat-input-charCount ui_text-small"},this.state.remainingPostChars),n.a.createElement("span",{className:"ui_inclusively-hidden"},"characters remaining"))),n.a.createElement("input",{id:"chatInput",className:"chat-input",type:"text",placeholder:"what's happening?",maxLength:this.state.maxPostChars,autoComplete:"off",required:!0,ref:"chatInput",onKeyUp:this.remainingChars,disabled:this.state.formBusy}),n.a.createElement("button",{id:"chatSubmit",className:"chat-submit",type:"submit",disabled:this.state.formBusy},n.a.createElement(v,{className:"chat-submit-icon"}),n.a.createElement("span",{className:"ui_inclusively-hidden"},"submit"))))}}]),e}(s.Component),E=function(t){function e(){return Object(o.a)(this,e),Object(l.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return n.a.createElement(b,null)}}]),e}(s.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.hydrate(n.a.createElement(E,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[11,1,2]]]);
//# sourceMappingURL=main.bbd0e70e.chunk.js.map